<!DOCTYPE html>
<html>

<head>
  <title>Blockchain Web Interface</title>
  <script>
    function addTransaction() {
      // Get the form data
      var form = document.getElementById("add-transaction-form");
      var sender = form.sender.value;
      var receiver = form.receiver.value;
      var amount = parseFloat(form.amount.value);
      var signature = form.signature.value;

      // Send the HTTP request
      fetch('/add_transaction', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ sender: sender, receiver: receiver, amount: amount, signature: signature })
      })
        .then(response => response.text())
        .then(data => {
          // Update the status message
          var status = document.getElementById("add-transaction-status");
          status.innerHTML = data;
          status.style.color = 'green';
        })
        .catch(error => {
          // Update the status message
          var status = document.getElementById("add-transaction-status");
          status.innerHTML = 'Error: ' + error.message;
          status.style.color = 'red';
        });
    }

    function getBlockchain() {
      // Send the HTTP request
      fetch('/get_blockchain')
        .then(response => response.json())
        .then(data => {
          // Update the blockchain table
          var table = document.getElementById("blockchain-table");
          table.innerHTML = '';
          for (var i = 0; i < data.length; i++) {
            var row = table.insertRow();
            var indexCell = row.insertCell(0);
            var transactionsCell = row.insertCell(1);
            var hashCell = row.insertCell(2);
            indexCell.innerHTML = data[i].index;
            transactionsCell.innerHTML = data[i].transactions.map(function (t) { return JSON.stringify(t); }).join('<br>');
            hashCell.innerHTML = data[i].hash;
          }
        })
        .catch(error => {
          // Update the status message
          var status = document.getElementById("get-blockchain-status");
          status.innerHTML = 'Error: ' + error.message;
          status.style.color = 'red';
        });
    }
  </script>
</head>

<body>
  <h1>Blockchain Web Interface</h1>

  <h2>Add Transaction</h2>
  <form id="add-transaction-form">
    <label>Sender:</label>
    <input type="text" name="sender"><br>
    <label>Receiver:</label>
    <input type="text" name="receiver"><br>
    <label>Amount:</label>
    <input type="text" name="amount"><br>
    <label>Signature:</label>
    <input type="text" name="signature"><br>
    <input type="button" value="Submit" onclick="addTransaction()">
  </form>
  <div id="add-transaction-status"></div>

  <h2>Blockchain</h2>
  <table id="blockchain-table">
    <tr>
      <th>Index</th>
      <th>Transactions</th>
      <th>Hash</th>
    </tr>
  </table>
  <input type="button" value="Refresh" onclick="getBlockchain()">
  <div id="get-blockchain-status"></div>

  <script>
    getBlockchain();
  </script>
</body>

</html>